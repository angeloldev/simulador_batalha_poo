{% extends "base.html" %}

{% block title %}Criar Personagem - Medieval Fantasy Battle Simulator{% endblock %}

{% block content %}
<div class="create-character-container">
    <div class="create-header">
        <h2>üßô‚Äç‚ôÇÔ∏è Criar Novo Her√≥i</h2>
        <p>Escolha sua classe e forje sua lenda em Eldoria</p>
    </div>

    <form method="POST" class="character-form">
        <div class="form-section">
            <h3>üìù Informa√ß√µes B√°sicas</h3>
            <div class="form-group">
                <label for="nome">Nome do Personagem:</label>
                <input type="text" id="nome" name="nome" required 
                       placeholder="Digite o nome do seu her√≥i" maxlength="50">
            </div>
        </div>

        <div class="form-section">
            <h3>‚öîÔ∏è Escolha sua Classe</h3>
            <div class="class-selection">
                <div class="class-option">
                    <input type="radio" id="guerreiro" name="classe" value="guerreiro" required>
                    <label for="guerreiro" class="class-card guerreiro">
                        <div class="class-icon">üõ°Ô∏è</div>
                        <div class="class-info">
                            <h4>Guerreiro</h4>
                            <p>Mestre do combate f√≠sico com for√ßa e resist√™ncia superiores</p>
                            <div class="class-stats">
                                <div class="stat">üí™ For√ßa: Alta</div>
                                <div class="stat">üõ°Ô∏è Defesa: Alta</div>
                                <div class="stat">‚ù§Ô∏è Vida: 120</div>
                                <div class="stat">‚ö° Recurso: F√∫ria</div>
                            </div>
                            <div class="class-abilities">
                                <strong>Habilidades:</strong>
                                <ul>
                                    <li>Golpe Poderoso</li>
                                    <li>Provocar</li>
                                    <li>Postura Defensiva</li>
                                </ul>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="class-option">
                    <input type="radio" id="mago" name="classe" value="mago">
                    <label for="mago" class="class-card mago">
                        <div class="class-icon">üîÆ</div>
                        <div class="class-info">
                            <h4>Mago</h4>
                            <p>Manipulador de magia arcana com feiti√ßos devastadores</p>
                            <div class="class-stats">
                                <div class="stat">üß† Intelig√™ncia: Alta</div>
                                <div class="stat">üí• Dano M√°gico: Alto</div>
                                <div class="stat">‚ù§Ô∏è Vida: 80</div>
                                <div class="stat">üíô Recurso: Mana</div>
                            </div>
                            <div class="class-abilities">
                                <strong>Habilidades:</strong>
                                <ul>
                                    <li>Bola de Fogo</li>
                                    <li>Raio de Gelo</li>
                                    <li>Barreira Arcana</li>
                                </ul>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="class-option">
                    <input type="radio" id="arqueiro" name="classe" value="arqueiro">
                    <label for="arqueiro" class="class-card arqueiro">
                        <div class="class-icon">üèπ</div>
                        <div class="class-info">
                            <h4>Arqueiro</h4>
                            <p>Especialista em combate √† dist√¢ncia com precis√£o letal</p>
                            <div class="class-stats">
                                <div class="stat">üéØ Destreza: Alta</div>
                                <div class="stat">üí• Cr√≠tico: Alto</div>
                                <div class="stat">‚ù§Ô∏è Vida: 95</div>
                                <div class="stat">üíö Recurso: Stamina</div>
                            </div>
                            <div class="class-abilities">
                                <strong>Habilidades:</strong>
                                <ul>
                                    <li>Tiro Certeiro</li>
                                    <li>Chuva de Flechas</li>
                                    <li>Evas√£o</li>
                                </ul>
                            </div>
                        </div>
                    </label>
                </div>
            </div>
        </div>

        <div class="form-section">
            <h3>üìä Preview do Personagem</h3>
            <div class="character-preview" id="character-preview">
                <div class="preview-placeholder">
                    <div class="preview-icon">üë§</div>
                    <p>Selecione uma classe para ver o preview</p>
                </div>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary btn-large">
                ‚öîÔ∏è Criar Personagem
            </button>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary btn-large">
                ‚Ü©Ô∏è Voltar ao Dashboard
            </a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const classOptions = document.querySelectorAll('input[name="classe"]');
        const characterPreview = document.getElementById('character-preview');
        const nameInput = document.getElementById('nome');
        
        // Dados das classes para preview
        const classData = {
            guerreiro: {
                icon: 'üõ°Ô∏è',
                name: 'Guerreiro',
                description: 'Tanque resistente especializado em combate corpo a corpo',
                stats: {
                    'Vida': 120,
                    'For√ßa': 15,
                    'Defesa': 13,
                    'Destreza': 10,
                    'Intelig√™ncia': 8
                },
                resource: 'F√∫ria (100)',
                color: '#d32f2f'
            },
            mago: {
                icon: 'üîÆ',
                name: 'Mago',
                description: 'Conjurador poderoso com magia elemental',
                stats: {
                    'Vida': 80,
                    'For√ßa': 8,
                    'Defesa': 6,
                    'Destreza': 10,
                    'Intelig√™ncia': 15
                },
                resource: 'Mana (100)',
                color: '#1976d2'
            },
            arqueiro: {
                icon: 'üèπ',
                name: 'Arqueiro',
                description: 'Atirador preciso com alta chance de cr√≠tico',
                stats: {
                    'Vida': 95,
                    'For√ßa': 10,
                    'Defesa': 8,
                    'Destreza': 15,
                    'Intelig√™ncia': 10
                },
                resource: 'Stamina (100) + Flechas (20)',
                color: '#388e3c'
            }
        };
        
        // Atualizar preview quando classe for selecionada
        classOptions.forEach(option => {
            option.addEventListener('change', function() {
                if (this.checked) {
                    updateCharacterPreview(this.value);
                    
                    // Adicionar classe visual ao card selecionado
                    document.querySelectorAll('.class-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    this.nextElementSibling.classList.add('selected');
                }
            });
        });
        
        // Atualizar preview quando nome mudar
        nameInput.addEventListener('input', function() {
            const selectedClass = document.querySelector('input[name="classe"]:checked');
            if (selectedClass) {
                updateCharacterPreview(selectedClass.value);
            }
        });
        
        function updateCharacterPreview(className) {
            const data = classData[className];
            const characterName = nameInput.value || 'Seu Her√≥i';
            
            characterPreview.innerHTML = `
                <div class="preview-card ${className}">
                    <div class="preview-header">
                        <div class="preview-avatar">
                            <div class="avatar-icon">${data.icon}</div>
                        </div>
                        <div class="preview-info">
                            <h4>${characterName}</h4>
                            <div class="preview-class">${data.name}</div>
                            <div class="preview-level">N√≠vel 1</div>
                        </div>
                    </div>
                    
                    <div class="preview-description">
                        <p>${data.description}</p>
                    </div>
                    
                    <div class="preview-stats">
                        <h5>Atributos Iniciais:</h5>
                        <div class="stats-grid">
                            ${Object.entries(data.stats).map(([stat, value]) => `
                                <div class="stat-item">
                                    <span class="stat-name">${stat}</span>
                                    <span class="stat-value">${value}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="preview-resource">
                        <strong>Recurso:</strong> ${data.resource}
                    </div>
                </div>
            `;
        }
        
        // Valida√ß√£o do formul√°rio
        const form = document.querySelector('.character-form');
        form.addEventListener('submit', function(e) {
            const name = nameInput.value.trim();
            const selectedClass = document.querySelector('input[name="classe"]:checked');
            
            if (!name) {
                e.preventDefault();
                alert('Por favor, digite um nome para seu personagem.');
                nameInput.focus();
                return;
            }
            
            if (name.length < 2) {
                e.preventDefault();
                alert('O nome deve ter pelo menos 2 caracteres.');
                nameInput.focus();
                return;
            }
            
            if (!selectedClass) {
                e.preventDefault();
                alert('Por favor, selecione uma classe para seu personagem.');
                return;
            }
            
            // Anima√ß√£o de loading
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.innerHTML = '‚è≥ Criando personagem...';
            submitBtn.disabled = true;
        });
        
        // Anima√ß√µes de entrada
        const cards = document.querySelectorAll('.class-card');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 200);
        });
    });
</script>
{% endblock %}